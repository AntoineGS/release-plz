<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Triggering further workflows - Release-plz</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Release rust packages without using the command line.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="../installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../usage/index.html"><strong aria-hidden="true">2.</strong> CLI Usage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../usage/update.html"><strong aria-hidden="true">2.1.</strong> update</a></li><li class="chapter-item expanded "><a href="../usage/release-pr.html"><strong aria-hidden="true">2.2.</strong> release-pr</a></li><li class="chapter-item expanded "><a href="../usage/release.html"><strong aria-hidden="true">2.3.</strong> release</a></li><li class="chapter-item expanded "><a href="../usage/shell-completions.html"><strong aria-hidden="true">2.4.</strong> shell-completions</a></li></ol></li><li class="chapter-item expanded "><a href="../github/index.html"><strong aria-hidden="true">3.</strong> GitHub Action</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../github/trigger.html" class="active"><strong aria-hidden="true">3.1.</strong> Triggering further workflows</a></li><li class="chapter-item expanded "><a href="../github/update.html"><strong aria-hidden="true">3.2.</strong> Keep the action up-to-date</a></li></ol></li><li class="chapter-item expanded "><a href="../changelog-format.html"><strong aria-hidden="true">4.</strong> Changelog format</a></li><li class="chapter-item expanded "><a href="../config.html"><strong aria-hidden="true">5.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../why.html"><strong aria-hidden="true">6.</strong> Why yet another release tool</a></li><li class="chapter-item expanded "><a href="../extra/index.html"><strong aria-hidden="true">7.</strong> Extra</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../extra/releasing-binaries.html"><strong aria-hidden="true">7.1.</strong> Releasing binaries</a></li><li class="chapter-item expanded "><a href="../extra/single-changelog.html"><strong aria-hidden="true">7.2.</strong> Single changelog</a></li><li class="chapter-item expanded "><a href="../extra/yanked-packages.html"><strong aria-hidden="true">7.3.</strong> Yanked packages</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Release-plz</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/MarcoIeni/release-plz" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/MarcoIeni/release-plz/edit/main/docs/src/github/trigger.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="triggering-further-workflow-runs"><a class="header" href="#triggering-further-workflow-runs">Triggering further workflow runs</a></h1>
<p>GitHub Actions using the default
<a href="https://docs.github.com/en/actions/security-guides/automatic-token-authentication"><code>GITHUB_TOKEN</code></a>
cannot trigger other workflows.
For example:</p>
<ul>
<li><code>on: pull_request</code> or <code>on: push</code> workflows acting as checks on pull
requests opened by GitHub Actions won’t run.</li>
<li><code>on: release</code> or <code>on: push: tags</code> workflows acting on releases or
tags created by GitHub actions won’t run.</li>
</ul>
<p>You can learn more in the GitHub
<a href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow#triggering-a-workflow-from-a-workflow">docs</a>.</p>
<h2 id="how-to-trigger-further-workflow-runs"><a class="header" href="#how-to-trigger-further-workflow-runs">How to trigger further workflow runs</a></h2>
<p>Release-plz doesn’t need to trigger further workflow runs to release your packages.
However, if you want to run CI checks on the release PR,
or if you want to trigger another workflow after release-plz pushes
a tag or creates a release, you need to use one of the following methods.</p>
<h3 id="trigger-workflow-manually"><a class="header" href="#trigger-workflow-manually">Trigger workflow manually</a></h3>
<p>To run <code>on: pull_request</code> workflows you can manually close and reopen the release pull request.</p>
<h3 id="use-a-personal-access-token"><a class="header" href="#use-a-personal-access-token">Use a Personal Access Token</a></h3>
<p>Use a <a href="https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token">Personal Access Token (PAT)</a>
created on an account with write access to the repository.
This is the standard method
<a href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow#triggering-a-workflow-from-a-workflow">recommended by GitHub</a>.</p>
<p>Note that the account that owns the PAT will be the author of the release pull request.
If you don’t want release-plz to open release pull requests with your account,
consider creating a
<a href="https://docs.github.com/en/get-started/learning-about-github/types-of-github-accounts#personal-accounts">machine user</a>.
If your machine user needs a cool avatar, you can use the release-plz <a href="../assets/robot_head.jpeg">logo</a>).</p>
<p>Create the PAT, choosing one of the two types:</p>
<ul>
<li><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#fine-grained-personal-access-tokens">Fine-grained</a>:
more secure because you can select the repositories where the PAT can be used.
Release-plz needs the following:
<ul>
<li>Select the repositories where you want to use the PAT, to give release-plz write access:
<img src="../assets/repository-access.png" alt="pat repository access" /></li>
<li>Assign “Contents” and “Pull requests” read and write permissions:
<img src="../assets/pat-overview.png" alt="pat fine permissions" /></li>
</ul>
</li>
<li><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#personal-access-tokens-classic">Classic</a>:
less secure because you can’t scope it to a single repository.
Release-plz needs <code>repo</code> permissions:
<img src="../assets/pat-classic.png" alt="pat classic permissions" /></li>
</ul>
<p>Once you generated your token, save it in the
<a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">secrets</a>,
and pass it to both the <code>actions/checkout</code> and <code>release-plz</code> actions:</p>
<pre><code class="language-yaml">jobs:
  release-plz:
    name: Release-plz
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
          token: ${{ secrets.RELEASE_PLZ_TOKEN }} # &lt;-- PAT secret name
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - name: Run release-plz
        uses: MarcoIeni/release-plz-action@v0.5
        env:
          GITHUB_TOKEN: ${{ secrets.RELEASE_PLZ_TOKEN }} # &lt;-- PAT secret name
          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
</code></pre>
<h3 id="use-a-github-action"><a class="header" href="#use-a-github-action">Use a GitHub Action</a></h3>
<p>Generate a GitHub token with a GitHub App.
This is the approach used by the
<a href="https://github.com/MarcoIeni/release-plz/blob/main/.github/workflows/release-plz.yml">release-plz</a>
repo itself. With this approach, the GitHub App will be the author of the release pull request.</p>
<p>Here’s how to use a GitHub app to generate a GitHub token:</p>
<ol>
<li>
<p>Create a minimal <a href="https://docs.github.com/en/developers/apps/creating-a-github-app">GitHub App</a>,
setting the following fields:</p>
<ul>
<li>Set <code>GitHub App name</code>.</li>
<li>Set <code>Homepage URL</code> to anything you like, such as your GitHub profile page.</li>
<li>Uncheck <code>Active</code> under <code>Webhook</code>. You do not need to enter a <code>Webhook URL</code>.</li>
<li>Under <code>Repository permissions: Contents</code> select <code>Access: Read &amp; write</code>.</li>
<li>Under <code>Repository permissions: Pull requests</code> select <code>Access: Read &amp; write</code>.</li>
<li>(Optional) Set the release-plz <a href="../assets/robot_head.jpeg">logo</a>.</li>
</ul>
</li>
<li>
<p>Create a Private key from the App settings page and store it securely.</p>
</li>
<li>
<p>Install the App on the repositories where you want to run release-plz.</p>
</li>
<li>
<p>Store the GitHub App ID, and the private
key you created in step 2 in GitHub
<a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">secrets</a>.
E.g. <code>APP_ID</code>, <code>APP_PRIVATE_KEY</code>.</p>
</li>
<li>
<p>Use
<a href="https://github.com/tibdex/github-app-token">tibdex/github-app-token</a>
to generate a token from the GitHub Action:</p>
<pre><code class="language-yaml">steps:
  # Generating a GitHub token, so that PRs and tags created by
  # the release-plz-action can trigger actions workflows.
  - name: Generate GitHub token
    uses: tibdex/github-app-token@v1
    id: generate-token
    with:
      app_id: ${{ secrets.APP_ID }} # &lt;-- GitHub App ID secret name
      private_key: ${{ secrets.APP_PRIVATE_KEY }} # &lt;-- GitHub App private key secret name
  - name: Checkout repository
    uses: actions/checkout@v3
    with:
      fetch-depth: 0
      token: ${{ steps.generate-token.outputs.token }}
  - name: Install Rust toolchain
    uses: dtolnay/rust-toolchain@stable
  - name: Run release-plz
    uses: MarcoIeni/release-plz-action@main
    env:
      GITHUB_TOKEN: ${{ steps.generate-token.outputs.token }}
      CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
</code></pre>
</li>
</ol>
<h2 id="how-to-trigger-further-workflows"><a class="header" href="#how-to-trigger-further-workflows">How to trigger further workflows</a></h2>
<p>You can trigger workflows on different
<a href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows">events</a>.
For example:</p>
<ul>
<li>
<p>When a GitHub release is published:</p>
<pre><code class="language-yaml">on:
  release:
    types: [published]
</code></pre>
</li>
<li>
<p>When a git tag is pushed:</p>
<pre><code class="language-yaml">on:
  push:
    tags:
      - &quot;*&quot;
</code></pre>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../github/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../github/update.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../github/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../github/update.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
